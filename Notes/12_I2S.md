## I2C (SSI or TWI)

Two Wire Interface
Inter-Integrated Circuit
Synchronous Serial Interface

#### DIO Circuit Implementaion

##### Push-Pull connection

![ssi1](imgs/ssi1.JPG)
because push 1 or pulled 0

##### Open-drain(PMOS)/ open collector(PNP)

![ssi2](imgs/ssi2.JPG)

##### Open-drain uses

###### 1- provide connection with high power loads (because it will be isolated from high power load)

![ssi3](imgs/ssi3.JPG)
floating MCU pin means now mcu will be disconnected to load connected to this pin.

###### 2- can implement communication bus with multiMaster

intuatively allows MCUs communicate with each other

can be done if only one MCU speaks and others listen

`what if 2 MCUs speaks in the same time this will NOT cause HW problems (because it's open-drain connection), but we should this arbitration(خناقه)`

![ssi4](imgs/ssi4.JPG)

oberservation: 0 here is the dominant state (البتايه `المسيطره`)

> **Dominant Bit / state**: value which is seen on the bus when at least one node writes it
> **Recessive Bit**: value which appears on the bus when when all nodes write it

---

#### I2C

##### HW Interface

![ssi5](imgs/ssi5.JPG)

##### I2C Specifications

![ssi6](imgs/ssi6.JPG)

- **Rule**: only master at a time (واحد بس يتكلم مش كله بيتكلم في نفس واحد )

##### I2C Frame Format

1- **start `condition`**:
يلا السلام عليكم هنبدا نتكلم مع خصراتكم
![ssi7](imgs/ssi7.JPG)
2- **stop `condition`**:
![ssi8](imgs/ssi8.JPG)

- Data:
  ![ssi9](imgs/ssi9.JPG)

##### How master select a specific slave to speak with him?

give it a **ID** and if the slave see his ID will know that this message for him

id == slave address
observation: max nodes of TWI protocol is 128 node

- **Note**: Always read signal always 1 (high) and write always is 0 in any communication protocols even in parallel like LCD

![ssi10](imgs/ssi10.JPG)

- In I2c After each 8 bits should someone(selected slave) respones with ACK

- Acknowledge (تمام)
  - 0: selected slave says ok
  - 1: no one response (default bus state)
- I2C packet is 9 bits
- First Packet in frame called Address Packet(contains slave address)
